<?xml version="1.0" encoding="utf-8"?>
<odoo>
     <template id="factures_mm.detail_client">
<div>

    <table id="tab_produits">
          <tr style="height:30px !important; font-weight:bold">
            <td>CODE</td>
            <td>DESIGNATION</td>
            <td>QTE</td>
            <td>UNITE</td>

              <td>P.U. HTVA</td>
            <td>REMISE</td>
            <td>TVA</td>
            <td>MONTANT HT</td>
          </tr>


          <tr t-foreach="o.invoice_line_ids" t-as="l" style="font-size:13px !important; height:30px !important">
            <td style="border-bottom:0px; border-top:0px; width:50px"><span t-field="l.product_id.default_code"/></td>
              <t t-set="designation_name" t-value="l.name"/>
            <td style="border-bottom:0px; border-top:0px; width:300px; text-align:left; padding-left:5px"><span t-esc="designation_name.split(']')[1]"/></td>
            <td style="border-bottom:0px; border-top:0px;width:80px; text-align:right; padding-left:5px; padding-right:5px"><span t-esc="'{0:,.2f}'.format(l.quantity).replace('.', ',')"/> </td>
            <td style="border-bottom:0px; border-top:0px;width:80px; text-align:right; padding-left:5px; padding-right:5px"> <span t-field="l.uom_id"/></td>
            <td style="border-bottom:0px; border-top:0px; width:90px; text-align:right; padding-right:5px; width:100px">
                 <span t-esc="'{0:,.0f}'.format(l.price_unit).replace(',', ' ')"/> </td>
             <!--<td style="border-bottom:0px; border-top:0px; width:90px; text-align:right; padding-right:5px;"><span t-esc="o.separateur_millier(int(l.price_unit))"/></td>-->
            <td style="border-bottom:0px; border-top:0px;  width:70px; text-align:right; padding-right:5px;"><span t-field="l.discount"/>%</td>
            <td style="border-bottom:0px; border-top:0px; width:60px; text-align:right; padding-right:5px;"><span t-esc="'{0:,.0f}'.format(int(l.invoice_line_tax_ids.amount))"/>%</td>
            <td style="border-bottom:0px; border-top:0px; text-align:right; padding-right:5px;"><span t-esc="o.separateur_millier(int(l.price_subtotal))"
                                        /></td>
          </tr>
            <tr>
                <td style="border-top:0px"></td>
                <td style="border-top:0px"></td>
                <td style="border-top:0px"></td>
                <td style="border-top:0px"></td>
                <td style="border-top:0px"></td>
                <td style="border-top:0px"></td>
                <td style="border-top:0px"></td>
                <td style="border-top:0px"></td>
            </tr>
    </table>
        <!--Fin Table Designations-->
 </div>

   <div>
    <div>
    <!--<div class="keeptogether">-->
    <!--Debut Totaux-->

       <table class="table table-bordered" style="width:100%;border-color:black;border-width: 1px solid black;">
                  <tfoot>
                      <tr>


                          <td class="col-xs-2" style="width:15%;border-width: 1px solid black;border-color:black; text-align:center; font-weight:bold">BASE</td>
                          <td class="col-xs-2" style="width:8%;border-width: 1px solid black;border-color:black; text-align:center;font-weight:bold">TVA</td>
                           <td class="col-xs-2" style="width:15%;border-width: 1px solid black;border-color:black; text-align:center;font-weight:bold">MONTANT TVA</td>
                          <td class="col-xs-2" style="width:17%;border-width: 1px solid black;border-color:black; text-align:center;font-weight:bold">MONTANT REMISE</td>
                          <td class="col-xs-2" style="width:15%;border-width: 1px solid black;border-color:black; text-align:center;font-weight:bold">TOTAL HT</td>

                          <td class="col-xs-2" style="width:20%;border-width: 1px solid black;border-color:black; text-align:center;font-weight:bold" >NET A PAYER</td>
                      </tr>
                      <tr t-if="o.existe_taux_18() == 'OUI'">


                          <td style="text-align:center;border-width: 1px solid black;border-color:black;"><span t-esc="o.separateur_millier(o.total_taxable())"/> FCFA</td>
                          <td style="text-align:center;border-width: 1px solid black;border-color:black;">18%</td>
                          <td style="text-align:center;border-width: 1px solid black;border-color:black;"><span t-esc="o.separateur_millier(o.amount_tax)"/> FCFA</td>
                          <td style="text-align:center;border-width: 1px solid black;border-color:black;"><span t-esc="o.separateur_millier(o.total_remise_non_taxable())"/> FCFA</td>
                          <td style="text-align:center;border-width: 1px solid black;border-color:black;font-weight:bold; vertical-align:middle" t-att-rowspan="o.nombre_ligne_tva()"><span t-esc="o.separateur_millier(o.amount_untaxed)"/> FCFA</td>
                          <td style="text-align:center;border-width: 1px solid black;border-color:black; font-weight:bold; vertical-align:middle" t-att-rowspan="o.nombre_ligne_tva()"><span t-esc="o.separateur_millier(o.arrondir(o.amount_total))"/> FCFA</td>

                      </tr>

                      <tr t-if="o.existe_taux_0() == 'OUI'">


                          <td style="text-align:center;border-width: 1px solid black;border-color:black;" ><span t-esc="o.separateur_millier(o.total_non_taxable())"/> FCFA</td>
                          <td style="text-align:center;border-width: 1px solid black;border-color:black;">0%</td>
                          <td style="text-align:center;border-width: 1px solid black;border-color:black;">0 FCFA</td>
                          <td style="text-align:center;border-width: 1px solid black;border-color:black;"><span t-esc="o.separateur_millier(o.total_remise_taxable())"/> FCFA</td>
                          <td t-if="o.existe_taux_18() == 'NON'" style="text-align:center;border-width: 1px solid black;border-color:black;font-weight:bold; vertical-align:middle"><span t-esc="o.separateur_millier(o.amount_untaxed)"/> FCFA</td>
                          <td t-if="o.existe_taux_18() == 'NON'" style="text-align:center;border-width: 1px solid black;border-color:black;font-weight:bold; vertical-align:middle"><span t-esc="o.separateur_millier(o.arrondir(o.amount_total))"/> FCFA</td>

                      </tr>
                  </tfoot>
       </table>
       <!--Fin totaux-->

                <!--Debut montant lettre-->

                            <table style="width:100%; float: right;">



                                  <tr style="height:40px;">
                                            <td colspan="2" style="font-weight:bold">Arrêté la présente facture à: <t t-esc="o.montant_en_lettre(o.arrondir(o.amount_total), 'Francs CFA')"/>

                                             </td>

                                  </tr>


                            </table>

    <!--Fin montant lettre-->
       <div class="keeptogether" style="">
        <table width="100%">
              <tbody>
                  <tr>
                      <td class="col-xs-4" style="text-align:center">REGLEMENT:&#160;&#160; <span t-field="o.payment_term_id.name"/></td>
                      <td class="col-xs-4" style="text-align:center"> </td>
                      <td class="col-xs-4" style="text-align:center">ECHEANCE:&#160;&#160; <span t-field="o.date_due"/></td>
                  </tr>
              </tbody>
        </table>
          <br/>
            <div class="page_footer" style="margin-bottom:0px; margin-top:0px;">
                 <!-- Appeler le template pied-->

             <t  t-call="factures_mm.pied_client"/>
          </div>
        </div>
     </div>
   </div>

    </template>
</odoo>